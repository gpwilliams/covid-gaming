names_from = "subscale",
values_from = "score"
) %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = amotivation:introjected_regulation
)
# split data ----
# get keys
gam_keys <- list(
instrinsic_motivation = c(1:3),
integrated_regulation = c(4:6),
identified_regulation = c(7:9),
introjected_regulation = c(10:12),
external_regulation = c(13:15),
amotivation = c(16:18)
)
# gaming motivation index ----
# longer data: by item
item_data$gam_long <- wide_data_complete %>%
select(
response_id,
why_play_before_1:why_play_before_18,
why_play_after_1:why_play_after_18
) %>%
pivot_longer(
cols = - response_id,
names_to = c("time", "item"),
names_sep = "_",
names_prefix = "why_play_",
values_to = "score"
) %>%
mutate(
subscale = case_when(
item %in% gam_keys$instrinsic_motivation ~ "instrinsic_motivation",
item %in% gam_keys$integrated_regulation ~ "integrated_regulation",
item %in% gam_keys$identified_regulation ~ "identified_regulation",
item %in% gam_keys$introjected_regulation ~ "introjected_regulation",
item %in% gam_keys$external_regulation ~ "external_regulation",
item %in% gam_keys$amotivation ~ "amotivation"
)
) %>%
select(response_id, time, subscale, item, score)
# longer data: aggregated by subject
agg_data$gam_long <- item_data$gam_long %>%
group_by(time, subscale, item) %>%
mutate(score = impute_mean(score)) %>%
ungroup() %>%
group_by(response_id, time, subscale) %>%
summarise(score = sum(score)) %>%
mutate(score = score*2)
# widest data: aggregated by subject
agg_data$gam_wide <- agg_data$gam_long %>%
pivot_wider(
names_from = "subscale",
values_from = "score"
) %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = amotivation:introjected_regulation
)
# split data ----
# das scores ----
das_keys <- list(
stress = c(1, 6, 8, 11, 12, 14, 18),
anxiety = c(2, 4, 7, 9, 15, 19, 20),
depression = c(3, 5, 10, 13, 16, 17, 21),
prefix = c("das_before_", "das_after_")
)
# longer data: by item
item_data$das_long <- wide_data_complete %>%
select(c(
response_id,
das_before_1:das_before_21,
das_after_1:das_after_21
)) %>%
pivot_longer(
-response_id,
names_sep = "_",
names_to = c("das", "time", "item"),
values_to = "score"
) %>%
mutate(
subscale = case_when(
item %in% das_keys$stress ~ "stress",
item %in% das_keys$depression ~ "depression",
item %in% das_keys$anxiety ~ "anxiety"
)
) %>%
select(response_id, time, subscale, item, score)
# longer data: aggregated by subject
agg_data$das_long <- item_data$das_long %>%
group_by(time, subscale, item) %>%
mutate(score = impute_mean(score)) %>%
ungroup() %>%
group_by(response_id, time, subscale) %>%
summarise(score = sum(score)*2) # DASS21 scores are multiplied by 2
# widest data: aggregated by subject
agg_data$das_wide <- agg_data$das_long %>%
pivot_wider(
names_from = "subscale",
values_from = "score"
) %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = anxiety:stress
)
agg_data$loneliness_long <- item_data$loneliness_long %>%
group_by(time, item) %>%
mutate(score = impute_mean(score)) %>%
ungroup() %>%
group_by(response_id, time) %>%
summarise(score = sum(score))
# split data ----
# loneliness scores ----
loneliness_keys <- list(
items = c(1:3),
prefix = c("loneliness_before_", "loneliness_after_")
)
# long data: by item
item_data$loneliness_long <- wide_data_complete %>%
select(c(
response_id,
loneliness_before_1:loneliness_before_3,
loneliness_after_1:loneliness_after_3
)) %>%
pivot_longer(
-response_id,
names_sep = "_",
names_to = c("loneliness", "time", "item"),
values_to = "score"
) %>%
select(response_id, time, item, score)
# long data: aggregated by subject
agg_data$loneliness_long <- item_data$loneliness_long %>%
group_by(time, item) %>%
mutate(score = impute_mean(score)) %>%
ungroup() %>%
group_by(response_id, time) %>%
summarise(score = sum(score))
# wide data: aggregated by subject
agg_data$loneliness_wide <- agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = score
)
agg_data$loneliness_long
agg_data$loneliness_wide
agg_data$das_long
item_data$loneliness_long %>%
group_by(time, item) %>%
mutate(score = impute_mean(score))
item_data$das_long
item_data$loneliness_long
item_data$loneliness_long <- wide_data_complete %>%
select(c(
response_id,
loneliness_before_1:loneliness_before_3,
loneliness_after_1:loneliness_after_3
)) %>%
pivot_longer(
-response_id,
names_sep = "_",
names_to = c("loneliness", "time", "item"),
values_to = "score"
) %>%
mutate(subscale = "loneliness") %>%
select(response_id, time, subscale, item, score)
item_data$loneliness_long
agg_data$loneliness_long <- item_data$loneliness_long %>%
group_by(time, subscale, item) %>%
mutate(score = impute_mean(score)) %>%
ungroup() %>%
group_by(response_id, time) %>%
summarise(score = sum(score))
agg_data$loneliness_long
agg_data$loneliness_long <- item_data$loneliness_long %>%
group_by(time, subscale, item) %>%
mutate(score = impute_mean(score)) %>%
ungroup() %>%
group_by(response_id, time, subscale) %>%
summarise(score = sum(score))
agg_data$loneliness_long
agg_data$loneliness_wide <- agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = score
)
agg_data$loneliness_wide
agg_data$das_wide
agg_data$loneliness_wide <- agg_data$loneliness_long %>%
pivot_wider(
names_from = "subscale",
values_from = "score"
) %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = anxiety:stress
)
agg_data$loneliness_wide <- agg_data$loneliness_long %>%
pivot_wider(
names_from = "subscale",
values_from = "score"
) %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = "loneliness"
)
agg_data$loneliness_wide
agg_data$loneliness_long %>%
pivot_wider(
names_from = "subscale",
values_from = "score"
)
agg_data$loneliness_long
agg_data$loneliness_long %>%
pivot_wider(
names_from = "subscale",
values_from = "score"
)
agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = "loneliness"
)
agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = score
)
agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = score,
names_to = c("loneliness_before", "loneliness_after")
)
?pivot_wider
agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = score,
values_to = c("loneliness_before", "loneliness_after")
)
agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = score
)
agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = score,
names_glue = "{time}_{.value}"
)
agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = score,
names_glue = "{subscale}_{time}"
)
agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = score,
names_glue = "{.subscale}_{time}"
)
agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = score,
names_glue = "loneliness_{time}"
)
agg_data$loneliness_wide <- agg_data$loneliness_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = score,
names_glue = "loneliness_{time}"
) %>%
select(-subscale)
agg_data$loneliness_wide
agg_data$das_wide
# split data ----
# gaming habits ----
# gaming habits
games_habits_long <- wide_data_complete %>%
select(
response_id,
hours_before_1:hours_before_9,
hours_after_1:hours_after_9,
regularly_play_before,
total_hours_before,
regularly_play_after,
total_hours_after
) %>%
pivot_longer(
cols = c(
hours_before_1:hours_before_9,
hours_after_1:hours_after_9
),
names_to = c("time", "game"),
names_sep = "_",
names_prefix = "hours_",
values_to = "hours"
)  %>%
select(
response_id,
game,
time,
regularly_play_before,
regularly_play_after,
hours
) %>%
mutate(
regularly_play = case_when(
time == "before" & regularly_play_before == "yes" ~ "yes",
time == "after" & regularly_play_after == "yes" ~ "yes",
TRUE ~ "no"
)
) %>%
select(-c(regularly_play_before, regularly_play_after))
# single and multiplayer
single_multi <- wide_data_complete %>%
select(
response_id,
games_single_muliplayer_before_1:games_single_muliplayer_before_9,
games_single_muliplayer_after_1: games_single_muliplayer_after_9
) %>%
pivot_longer(
-response_id,
names_to = c("time", "behaviour"),
names_sep = "_",
names_prefix = "games_single_muliplayer_",
values_to = "value"
) %>%
pivot_wider(
names_from = "behaviour",
names_prefix = "single_multi_"
)
# data to long format
single_multi_long <- single_multi %>%
select(response_id, time, single_multi_1:single_multi_9) %>%
pivot_longer(
-c(response_id, time),
names_prefix = "single_multi_",
names_to = "game",
values_to = "single_multi"
)
# longer data: by item ----
item_data$games_played_long <- left_join(
games_habits_long,
single_multi_long,
by = c("response_id", "time", "game")
)
item_data$games_played_long
regularly_play_agg <- wide_data_complete %>%
select(
response_id,
regularly_play_before,
regularly_play_after
) %>%
pivot_longer(
-response_id,
names_to = "time",
values_to = "regularly_play",
names_prefix = "regularly_play_"
)
games_played_agg <- wide_data_complete %>%
select(
response_id,
total_hours_before,
total_hours_after
) %>%
pivot_longer(
-response_id,
names_to = "time",
values_to = "total_hours_played",
names_prefix = "total_hours_"
)
agg_data$games_played <- full_join(regularly_play_agg, games_played_agg)
agg_data$games_played
agg_data$games_played_long <- full_join(regularly_play_agg, games_played_agg)
# widest data:
agg_data$games_played_wide <- agg_data$games_played_long %>%
arrange(desc(time)) %>%
pivot_wider(
names_from = "time",
values_from = regularly_play:total_hours_played
)
agg_data$games_played_wide
# save data ----
message("Writing data to file.")
# save by subjects and item data ----
# as rds files
for(i in seq_along(item_data)) {
write_rds(
item_data[[i]],
here(
"02_data",
"02_cleaned",
"01_multilevel",
paste0(names(item_data[i]), ".rds")
)
)
}
# as csv
for(i in seq_along(item_data)) {
write_csv(
item_data[[i]],
here(
"02_data",
"02_cleaned",
"01_multilevel",
paste0(names(item_data[i]), ".csv")
)
)
}
# save by subjects data ----
# as rds files
for(i in seq_along(agg_data)) {
write_rds(
agg_data[[i]],
here(
"02_data",
"02_cleaned",
"02_aggregated",
paste0(names(agg_data[i]), ".rds")
)
)
}
# as csv
for(i in seq_along(agg_data)) {
write_csv(
agg_data[[i]],
here(
"02_data",
"02_cleaned",
"02_aggregated",
paste0(names(agg_data[i]), ".csv")
)
)
}
# save item names ----
# csv only; data types aren't important here
for(i in seq_along(names_data)) {
write_csv(
names_data[[i]],
here(
"02_data",
"03_summary",
paste0("item_labels_", names(names_data[i]), ".csv")
)
)
}
# save demographics data names ----
# all demographics
# as rds files
write_rds(
demo_data_details,
here(
"02_data",
"02_cleaned",
"02_aggregated",
"demographics.rds"
)
)
# as csv
write_csv(
demo_data_details,
here(
"02_data",
"02_cleaned",
"02_aggregated",
"demographics.csv"
)
)
# summary data: csv only; data types aren't important here
for(i in seq_along(demo_data)) {
write_csv(
demo_data[[i]],
here(
"02_data",
"03_summary",
paste0("demographics_", names(demo_data[i]), ".csv")
)
)
}
# save plots ----
for(i in seq_along(cluster_plots)) {
ggsave(
here("03_plots", paste0(names(cluster_plots[i]), ".png")),
cluster_plots[[i]],
height = 8,
width = 12
)
}
